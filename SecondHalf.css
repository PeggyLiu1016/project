        /* =========================================
           1. 全域字型與重置設定
           ========================================= */
        @charset "utf-8";
        @font-face {
            font-family: 'MyCuteFont';
            src: url('font/SentyWatermelon.ttf') format('truetype');
            font-weight: normal;
            font-style: normal;
        }

        /* 為了避免 Tailwind 影響遊戲頁面原本的樣式，
           我們針對遊戲頁面的元素維持原有的字體設定 */
        .game-font-style {
            font-family: 'MyCuteFont', 'Microsoft JhengHei', sans-serif;
        }

            body, html {
            margin: 0;
            padding: 0;
            width: 100%;
            height: 100%;
            font-family: 'MyCuteFont', 'Noto Sans TC', 'Microsoft JhengHei', sans-serif;
            overflow: hidden; /* 防止整體捲動，個別視圖自己處理 */
            background-color: #b6a780;
        }

        /* =========================================
           2. SPA 視圖容器設定
           ========================================= */
        .spa-view {
            display: none; /* 預設隱藏 */
            width: 100%;
            height: 100%;
            position: absolute;
            top: 0;
            left: 0;
            overflow: hidden; /* 預設隱藏捲軸 */
        }

        .spa-view.active {
            display: flex; /* 顯示時使用 flex */
        }

        /* 宣導頁面需要捲動，且使用 Tailwind 的 block/flex 混合 */
        #view-education.active {
            display: flex; 
            flex-direction: column;
            overflow-y: auto; /* 允許垂直捲動 */
        }

        /* =========================================
           3. 遊戲頁面樣式
           ========================================= */
        #view-game {
            background-image: url('All_assets/8聊天室背景.png');
            background-size: 100% 100%;
            background-position: center;
            background-repeat: no-repeat;
            justify-content: center;
            align-items: center;
            background-color: #dcd4c0;
        }

        #view-game * {
            box-sizing: border-box;
            user-select: none;
            font-family: 'MyCuteFont', 'Microsoft JhengHei', sans-serif;
        }

                /* 修正：強制讓 FontAwesome 圖示使用正確的字體，避免被上面的通配符覆蓋 */
        #view-game .fas, #view-game .fa {
            font-family: "Font Awesome 6 Free", "FontAwesome" !important;
            font-weight: 900;
        }
        
        #view-game input { user-select: auto; }

        /* 隱形點擊層 (教學用) */
        #tutorial-overlay {
            position: absolute; top: 0; left: 0; width: 100%; height: 100%;
            background-color: transparent; z-index: 200; 
            pointer-events: auto; display: none; cursor: pointer;
        }
        #tutorial-overlay.active { display: block; }

        /* 挖洞聚光燈 */
        #spotlight-effect {
            position: absolute; top: 50%; left: 50%; width: 0; height: 0;
            background-color: transparent;
            box-shadow: 0 0 5px 3000px rgba(0, 0, 0, 0.75);
            z-index: 100; pointer-events: none; opacity: 0;
            transform: translate(-50%, -50%);
            transition: opacity 0.3s ease-out; border-radius: 50%; 
        }
        #spotlight-effect.active { opacity: 1; }

        /* Layout Grid */
        .app-container {
            width: 100%; height: 100%; display: grid;
            grid-template-columns: 15% 1fr 15%;
            grid-template-rows: 5% 15% 1fr; 
            background-color: transparent; position: relative;
        }

        /* Colors & Fonts */
        :root { --brown-dark: #5D4037; }

        /* Elements */
        .window-title {
            grid-column: 1 / -1; grid-row: 1 / 2;
            background-color: transparent; display: flex; justify-content: center; align-items: center;
            font-weight: bold; font-size: 1rem; color: #333; margin-top: 1rem;
        }

        .header-cell { display: flex; align-items: center; background-color: transparent; padding: 0; }
        .header-left { grid-column: 1 / 2; justify-content: center; color: var(--brown-dark); font-weight: bold; font-size: 2rem; }
        .header-main { grid-column: 2 / 3; justify-content: space-between; padding: 0 5%; }
        .header-title-group { display: flex; align-items: center; gap: 10px; }
        .header-name { font-size: 3rem; font-weight: bold; color: black; line-height: 1; }
        .icon-wrapper { width: 40px; height: 40px; display: flex; align-items: center; justify-content: center; cursor: pointer; }
        .header-stats { display: flex; gap: 25px; font-size: 3em; color: var(--brown-dark); font-weight: bold; }
        .header-right { grid-column: 3 / 4; justify-content: center; font-weight: bold; font-size: 3rem; color: var(--brown-dark); }
        
        .sidebar-left { grid-column: 1 / 2; grid-row: 3 / 4; padding: 10px; }
        .contact-item { display: flex; align-items: center; padding: 10px; cursor: pointer; border-radius: 8px; }
        .contact-item.active { justify-content: center; }
        .contact-item .avatar { width: 70px; height: 70px; border-radius: 50%; background-color: var(--brown-dark); margin-right: 15px; flex-shrink: 0; background-position: center; background-size: cover; background-repeat: no-repeat; }
        .contact-name { font-weight: bold; font-size: 2rem; color: black; }

        .chat-area { 
            grid-column: 2 / 3; grid-row: 3 / 4; 
            display: flex; overflow: hidden; flex-direction: column; position: relative; 
        }
        .messages-list { 
            flex-grow: 1; padding: 20px 20px 20px 30px; 
            display: flex; flex-direction: column; gap: 20px; z-index: 1; 
            overflow-y: auto; 
        }
        
        /* 訊息樣式 */
        .message { display: flex; align-items: flex-end; max-width: 85%; }
        .message.received { align-self: flex-start; }
        .message.sent { align-self: flex-end; flex-direction: row-reverse; }
        .msg-avatar { 
            width: 80px; height: 80px; border-radius: 50%; background-color: #fff; margin: 0 15px; flex-shrink: 0; 
            display: flex; justify-content: center; align-items: center; color: white; font-size: 14px; 
            background-position: center; background-size: cover; background-repeat: no-repeat; 
        }
        .msg-content { 
            background-color: #aebdc3; padding: 15px 25px; border-radius: 25px; 
            min-width: 180px; min-height: 50px; position: relative; 
            font-size: 1.5rem; display: flex; align-items: center;
        }
        /* 接收到的訊息 (對方 - 左邊) - 維持灰藍色 */
        .message.received .msg-content {
            background-color: #acc4ce;
            color: black;
        }

        /* 發送出的訊息 (我方 - 右邊) - 改為亮綠色 (類似 LINE) */
        .message.sent .msg-content {
            background-color: #b1d1b8;
            color: black;
        }

        .input-area { padding: 15px; z-index: 2; display: flex; justify-content: center; margin: 0 10px; }
        .input-box { 
            width: 97%; height: 60px; background-color: rgb(211, 221, 223); border-radius: 25px; 
            display: flex; align-items: center; padding: 0 10px; margin-bottom: 1rem; margin-left: 2%; 
            color: black; font-weight: bold; font-size: 1.1rem; cursor: pointer; 
        }

        .sidebar-right { 
            grid-column: 3 / 4; grid-row: 3 / 4; 
            display: flex; flex-direction: column; align-items: center; padding-top: 20px; gap: 20px; 
        }
        .material-item { width: 90px; height: 60px; background-color: #aebdc3; border-radius: 30px; box-shadow: 0 2px 5px rgba(0,0,0,0.1); }
        .material-square { width: 90px; height: 90px; background-color: #aebdc3; border-radius: 5px; margin-bottom: 10px; box-shadow: 0 2px 5px rgba(0,0,0,0.1); }

        .tutorial-tooltip { 
            position: absolute; background-color: rgb(254, 255, 210); padding: 12px 24px; border-radius: 30px; 
            font-size: 15px; font-weight: bold; color: #333; box-shadow: 0 5px 20px rgba(0,0,0,0.2); 
            z-index: 150; opacity: 0; transform: translateY(10px); transition: opacity 0.3s, transform 0.3s; 
            pointer-events: none; white-space: pre-line; text-align: center; 
        }
        .tutorial-tooltip.show { opacity: 1; transform: translateY(0); }

        .modal { 
            position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%) scale(0.9); 
            background: rgb(255, 249, 199); padding: 40px 60px; border-radius: 20px; 
            border: 5px solid rgb(230, 220, 134); text-align: center; 
            box-shadow: 0 10px 40px rgba(0,0,0,0.4); z-index: 300; opacity: 0; pointer-events: none; 
            transition: all 0.5s; 
        }
        .modal.show { opacity: 1; transform: translate(-50%, -50%) scale(1); pointer-events: auto; }
        .modal h2 { font-size: 1.5rem; color: var(--brown-dark); margin-bottom: 15px; }
        .modal p { font-size: 1.2rem; color: #555; }

        .mission-modal { 
            position: absolute; top: 0; left: 0; width: 100%; height: 100%; 
            background-color: rgba(0, 0, 0, 0.6); z-index: 500; display: none; 
            justify-content: center; align-items: center; opacity: 0; transition: opacity 0.3s ease; 
        }
        .mission-modal.active { display: flex; opacity: 1; }
        .mission-container { position: relative; width: 80%; max-width: 500px; display: flex; justify-content: center; align-items: center; }
        .mission-bg { width: 100%; height: auto; display: block; filter: drop-shadow(0 5px 15px rgba(0,0,0,0.3)); }
        .mission-text { 
            position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); 
            width: 65%; height: 60%; color: #5D4037; text-align: center; 
            display: flex; flex-direction: column; justify-content: center; align-items: center; 
            font-weight: bold; font-size: 1.3rem; line-height: 1.6; overflow-y: auto; 
        }
        .mission-text h3 { margin-bottom: 15px; font-size: 1.6rem; color: #3e2b25; }

        /* =========================================
           4. 成功/失敗頁面樣式
           ========================================= */
        .end-view-background {
            background-image: url('All_assets/9背景彈窗.png');
            background-size: cover;
            background-position: center;
            width: 100%; height: 100%; display: flex;
            justify-content: center; align-items: center; padding: 20px;
        }

        .content-box-end {
            border-radius: 0; padding: 30px; max-width: 800px; width: 100%; text-align: center;
        }

        .content-box-end h1 {
            color: #795616; font-size: 2.1em; /*margin-bottom: 100px; */
            font-family: "MyCuteFont", "微軟正黑體", sans-serif;
        }

        .content-box-end p {
            color: #795616; font-size: 1.8em; line-height: 1.8; white-space: pre-line;
            font-weight: bold; padding-bottom: 270px; padding-top: 150px;
            font-family: "MyCuteFont", "微軟正黑體", sans-serif;
        }

        .next-button {
            position: absolute; bottom: 15%; right: 25%;
            width: 150px; height: 150px; background-color: transparent; border: none;
            cursor: pointer; transition: transform 0.2s ease, filter 0.3s ease;
            padding: 0; display: flex; flex-direction: column;
            align-items: center; justify-content: center;
        }

        .next-button img {
            width: 100%; height: 100%; object-fit: contain;
            position: absolute; top: 0; left: 0; z-index: 0;
        }

        .next-button span {
            position: relative; z-index: 1; color: white;
            font-size: 20px; font-weight: bold; text-shadow: 1px 1px 2px black;
            pointer-events: none;
        }
        
        .next-button:hover { transform: scale(1.05); }
        .next-button:hover img { filter: hue-rotate(45deg) brightness(1.2); }
        .next-button:active { transform: scale(1.1); }

        /* =========================================
           5. 宣導頁面自定義樣式 (與 Tailwind 併用)
           ========================================= */
        /* === 浣熊按鈕尺寸設定 === */
        .raccoon-btn {
            width: 10rem;  /* w-40 (160px) - 手機版 */
            height: 10rem;
            border-radius: 9999px; /* 確保圓形背景 */
        }

        /* 電腦版 (螢幕寬度大於 768px) */
        @media (min-width: 768px) {
            .raccoon-btn {
                width: 13rem; /* w-52 (208px) - 電腦版 */
                height: 13rem;
            }
        }

        /* 右下角按鈕專屬微調 */
        .fixed-btn {
            width: 8rem; height: 8rem;
        }
        @media (min-width: 768px) {
            .fixed-btn {
                width: 10rem; height: 10rem;
            }
        }